# Gap Analysis（ギャップ分析）
version: "1.0"
generated_at: "2025-02-07T12:00:00Z"

## Intent vs Reality（意図と現実の乖離）

### Gap-1: Slack連携機能の欠落
intent:
  from: "PURPOSE.md:28 - 今期の優先順位1: Slack→AI抽出パイプラインの構築"
  claim: "日次SlackスレッドからA-Dイベントを抽出できる"

reality:
  from: "C-006, C-008"
  fact: "Slack APIクライアントが未実装。実際のSlackメッセージを取得できない"

gap_severity: "HIGH"
impact: "リポジトリの核心機能（CF-001）が一部未達成"
assumptions:
  - id: "ASM-001"
    description: "ユーザーはSlackメッセージを手動でJSON形式に変換して入力することを想定"
    confidence: "low"

### Gap-2: 日次指標追跡機能の欠落
intent:
  from: "SYSTEM_CONSTITUTION.md:48 - 核心指標"
  claim: "日次で「新規A件数」「A→B件数」「滞留A年齢中央値」を追跡できる"

reality:
  from: "C-007"
  fact: "集計ロジックが未実装。日次指標を計算できない"

gap_severity: "HIGH"
impact: "リポジトリの存在意義（KPL可視化）が未達成"
assumptions:
  - id: "ASM-003"
    description: "現在は抽出結果を手動でシート/スプレッドシートに集計することを想定"
    confidence: "medium"

### Gap-3: Topic台帳機能の欠落
intent:
  from: "SYSTEM_CONSTITUTION.md:96 - 既存Topic台帳との紐付け"
  claim: "既存topic_idへの紐付けを優先（なければ新規作成）"

reality:
  from: "C-010"
  fact: "Topic台帳のフォーマット・永続化が未定義。実際の紐付けができない"

gap_severity: "MEDIUM"
impact: "重複Topicのマージ機能が使えない。毎回新しいTopic IDが生成される"

### Gap-4: ~~テストカバレッジ目標未達~~ ✅ CLOSED
intent:
  from: "intent.yml QA-001"
  claim: "テストカバレッジ >= 80%"

reality:
  from: "verification_results"
  fact: "カバレッジ100%を達成（目標80%を20%超過）"

gap_severity: "CLOSED"
impact: "なし"
closure_method: "test_coverage_improvements"
evidence: "pytest --cov=src により100% coverageを確認"

### Gap-5: Slack連携機能の欠落（CRITICAL - BLOCKING）
intent:
  from: "intent.yml QA-001"
  claim: "テストカバレッジ >= 80%"

reality:
  from: "C-004"
  fact: "カバレッジ未計測。8テストケース実装済みだが、全体のカバー率は不明"

gap_severity: "MEDIUM"
impact: "コード品質の保証が不十分"

## Dependency Gaps（依存関係の不足）
missing_dependencies:
  - name: "Slack SDK"
    purpose: "Slack API連携"
    urgency: "HIGH"

  - name: "データ永続化ライブラリ"
    purpose: "Topic台帳・イベントログの保存"
    options: ["sqlite3（標準）", "tinydb", "jsonファイル"]
    urgency: "MEDIUM"

## Documentation Gaps（ドキュメントの不足）
missing_docs:
  - title: "CONTRIBUTING.md"
    purpose: "開発環境セットアップ・テスト実行方法"
    urgency: "MEDIUM"

  - title: "インストール手順"
    purpose: "ユーザーがライブラリをインストールして使う方法"
    urgency: "HIGH"

  - title: "Slack API設定方法"
    purpose: "Slack Appの作成・Token取得方法"
    urgency: "HIGH"

## Priority Matrix（優先順位マトリックス）
| Gap ID | ギャップ | 重大度 | 緊急度 | 依存関係 |
|--------|---------|--------|--------|----------|
| Gap-1 | Slack連携機能 | HIGH | HIGH | なし |
| Gap-2 | 日次指標追跡 | HIGH | HIGH | Gap-1, Gap-3 |
| Gap-3 | Topic台帳 | MEDIUM | HIGH | なし |
| Gap-4 | テストカバレッジ | MEDIUM | MEDIUM | なし |

## Assumption-based Gaps（仮定に基づくギャップ）
based_on_ASM-001:
  assumption: "ユーザーはSlackメッセージを手動でJSON形式に変換して入力する"
  gap: "手動入力のUX・フォーマットが未定義"
  verification: "ユーザーインタビューまたはプロトタイプ作成"

based_on_ASM-002:
  assumption: "80%カバレッジ目標"
  gap: "現状のカバレッジが不明"
  verification: "pytest --cov 実施"
